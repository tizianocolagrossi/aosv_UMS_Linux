\hypertarget{proc_8h}{}\doxysection{proc.\+h File Reference}
\label{proc_8h}\index{proc.h@{proc.h}}


This file is the header of the \mbox{\hyperlink{proc_8c}{proc.\+c}} file.  


{\ttfamily \#include \char`\"{}utility.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ums.\+h\char`\"{}}\newline
{\ttfamily \#include $<$linux/kernel.\+h$>$}\newline
{\ttfamily \#include $<$linux/module.\+h$>$}\newline
{\ttfamily \#include $<$linux/slab.\+h$>$}\newline
{\ttfamily \#include $<$linux/proc\+\_\+fs.\+h$>$}\newline
{\ttfamily \#include $<$linux/seq\+\_\+file.\+h$>$}\newline
{\ttfamily \#include $<$linux/hashtable.\+h$>$}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structowner__proc}{owner\+\_\+proc}}
\begin{DoxyCompactList}\small\item\em contains the data of the ums owner directory that contain the scheduler dir with all the UMS thread created by the owner \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structworker__proc}{worker\+\_\+proc}}
\begin{DoxyCompactList}\small\item\em contains the data of the worker thread directory that contain the info file of the worker. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structums__proc}{ums\+\_\+proc}}
\begin{DoxyCompactList}\small\item\em contains the data of the UMS thread directory that will contain the info file of the UMS and the directory of the completion queue used by the UMS. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structcq__proc}{cq\+\_\+proc}}
\begin{DoxyCompactList}\small\item\em contains the data of the completion queue directory that will contain the worker thread contained in the completion queue. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{proc_8h_a6fe7d9e62ee0716c77bc5aa89f970152}\label{proc_8h_a6fe7d9e62ee0716c77bc5aa89f970152}} 
\#define {\bfseries MODULE\+\_\+\+PROC\+\_\+\+LOG}~\char`\"{}UMS\+\_\+\+PROC\+: \char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_a745ec858c8c4f382670f40b9086681a0}\label{proc_8h_a745ec858c8c4f382670f40b9086681a0}} 
\#define {\bfseries UMS\+\_\+\+PROC\+\_\+\+DEBUG}
\item 
\mbox{\Hypertarget{proc_8h_a18ba938c9030675035b3be843356a807}\label{proc_8h_a18ba938c9030675035b3be843356a807}} 
\#define {\bfseries HASH\+\_\+\+KEY\+\_\+\+SIZE}~10
\item 
\mbox{\Hypertarget{proc_8h_ab8a5b7ea6bc75437b17f64fab509e90f}\label{proc_8h_ab8a5b7ea6bc75437b17f64fab509e90f}} 
\#define {\bfseries NAME\+\_\+\+BUFF}~30
\item 
\mbox{\Hypertarget{proc_8h_a74c4e1e72964de291652bbec04e4e4c9}\label{proc_8h_a74c4e1e72964de291652bbec04e4e4c9}} 
\#define {\bfseries PROC\+\_\+\+DIR}~\char`\"{}ums\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_ae635fb64eaa34cc6297c88fe850ce530}\label{proc_8h_ae635fb64eaa34cc6297c88fe850ce530}} 
\#define {\bfseries SCHED\+\_\+\+DIR}~\char`\"{}schedulers\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_ac21a05521f1f4754fa3e457ce2facf6b}\label{proc_8h_ac21a05521f1f4754fa3e457ce2facf6b}} 
\#define {\bfseries WKT\+\_\+\+DIR}~\char`\"{}workers\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_a4f7b38223074c234b39b5e02b9679944}\label{proc_8h_a4f7b38223074c234b39b5e02b9679944}} 
\#define {\bfseries UMS\+\_\+\+INFO}~\char`\"{}ums\+\_\+info\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_a8e39108e8c9aed29f8967a061f1c9513}\label{proc_8h_a8e39108e8c9aed29f8967a061f1c9513}} 
\#define {\bfseries WKT\+\_\+\+INFO}~\char`\"{}wkt\+\_\+info\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_af991f1c728c427fd5929fb15cc818ced}\label{proc_8h_af991f1c728c427fd5929fb15cc818ced}} 
\#define {\bfseries UMS\+\_\+\+ALL\+\_\+\+DIR}~\char`\"{}.all\+\_\+ums\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_acc2fbd8a6d729f39a2b1725f98b2818a}\label{proc_8h_acc2fbd8a6d729f39a2b1725f98b2818a}} 
\#define {\bfseries WKT\+\_\+\+ALL\+\_\+\+DIR}~\char`\"{}.all\+\_\+wkt\char`\"{}
\item 
\mbox{\Hypertarget{proc_8h_a062fb4c73c3a5187f93b46c52e58b116}\label{proc_8h_a062fb4c73c3a5187f93b46c52e58b116}} 
\#define {\bfseries CQ\+\_\+\+ALL\+\_\+\+DIR}~\char`\"{}.all\+\_\+cq\char`\"{}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{proc_8h_abdd93b90513666aaadd628f70e40c1fc}\label{proc_8h_abdd93b90513666aaadd628f70e40c1fc}} 
typedef struct \mbox{\hyperlink{structowner__proc}{owner\+\_\+proc}} {\bfseries owner\+\_\+proc\+\_\+t}
\begin{DoxyCompactList}\small\item\em contains the data of the ums owner directory that contain the scheduler dir with all the UMS thread created by the owner \end{DoxyCompactList}\item 
\mbox{\Hypertarget{proc_8h_a53f6e28ecf60f58db22de49e454a44e7}\label{proc_8h_a53f6e28ecf60f58db22de49e454a44e7}} 
typedef struct \mbox{\hyperlink{structworker__proc}{worker\+\_\+proc}} {\bfseries worker\+\_\+proc\+\_\+t}
\begin{DoxyCompactList}\small\item\em contains the data of the worker thread directory that contain the info file of the worker. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{proc_8h_acd7369c11b87beb9747a2e4fb013c01b}\label{proc_8h_acd7369c11b87beb9747a2e4fb013c01b}} 
typedef struct \mbox{\hyperlink{structums__proc}{ums\+\_\+proc}} {\bfseries ums\+\_\+proc\+\_\+t}
\begin{DoxyCompactList}\small\item\em contains the data of the UMS thread directory that will contain the info file of the UMS and the directory of the completion queue used by the UMS. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{proc_8h_a68ac9312affc1a497851eced2d411fda}\label{proc_8h_a68ac9312affc1a497851eced2d411fda}} 
typedef struct \mbox{\hyperlink{structcq__proc}{cq\+\_\+proc}} {\bfseries cq\+\_\+proc\+\_\+t}
\begin{DoxyCompactList}\small\item\em contains the data of the completion queue directory that will contain the worker thread contained in the completion queue. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{proc_8h_a2cce105f1878949f055ac8fbb49450ad}{Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Created}} (int pid)
\begin{DoxyCompactList}\small\item\em Insert the created worker thread into the procfs. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_a9a86c1a056ba322a329c93bf8143756c}{Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Ended}} (int wkt\+\_\+pid)
\begin{DoxyCompactList}\small\item\em Remove the worker that has ended from the procfs. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_a4356ac452c746426b4d93a15c42642bd}{Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Appended}} (int wkt\+\_\+pid, int id)
\begin{DoxyCompactList}\small\item\em link a worker to its completion queue \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_a76c832658b824fdd3f3e7444eed36998}{Proc\+\_\+\+Update\+\_\+\+Ums\+\_\+\+Created}} (int pid, int pid\+\_\+owner, int id)
\begin{DoxyCompactList}\small\item\em Insert the new UMS into the proc fs and link the completion queue path to the UMS folder. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_ae521fa6c4855e5a5f57c00d51f2e1df0}{Proc\+\_\+\+Update\+\_\+\+Ums\+\_\+\+Ended}} (int ums\+\_\+pid)
\begin{DoxyCompactList}\small\item\em Remove the UMS directory from the proc fs. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_acd51dc9de3d740215e798d1bbb4588a6}{Proc\+\_\+\+Update\+\_\+\+Cq\+\_\+\+Created}} (int id)
\begin{DoxyCompactList}\small\item\em create a completion queue folder into the proc fs \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_aaf3fc9dd67e138eebe225f72d335eb19}{Proc\+\_\+\+Update\+\_\+\+Cq\+\_\+\+Deleted}} (int id)
\begin{DoxyCompactList}\small\item\em remove the completion queue folder from the proc fs \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_a0066639f9bfabe52b228b58f38ab5e09}{try\+\_\+build\+\_\+ums\+\_\+proc}} (void)
\begin{DoxyCompactList}\small\item\em initialize the main data structures for the proc part for the ums \end{DoxyCompactList}\item 
int \mbox{\hyperlink{proc_8h_a52e2e82400df1a7bdf070872d6aeb418}{clear\+\_\+ums\+\_\+proc}} (void)
\begin{DoxyCompactList}\small\item\em clear the data structures allocated from this part of the UMS kernel module \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file is the header of the \mbox{\hyperlink{proc_8c}{proc.\+c}} file. 

\begin{DoxyAuthor}{Author}
Tiziano Colagrossi \href{mailto:tiziano.colagrossi@gmail.com}{\texttt{ tiziano.\+colagrossi@gmail.\+com}} 
\end{DoxyAuthor}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{proc_8h_a52e2e82400df1a7bdf070872d6aeb418}\label{proc_8h_a52e2e82400df1a7bdf070872d6aeb418}} 
\index{proc.h@{proc.h}!clear\_ums\_proc@{clear\_ums\_proc}}
\index{clear\_ums\_proc@{clear\_ums\_proc}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{clear\_ums\_proc()}{clear\_ums\_proc()}}
{\footnotesize\ttfamily int clear\+\_\+ums\+\_\+proc (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



clear the data structures allocated from this part of the UMS kernel module 

\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_acd51dc9de3d740215e798d1bbb4588a6}\label{proc_8h_acd51dc9de3d740215e798d1bbb4588a6}} 
\index{proc.h@{proc.h}!Proc\_Update\_Cq\_Created@{Proc\_Update\_Cq\_Created}}
\index{Proc\_Update\_Cq\_Created@{Proc\_Update\_Cq\_Created}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Cq\_Created()}{Proc\_Update\_Cq\_Created()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Cq\+\_\+\+Created (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}



create a completion queue folder into the proc fs 


\begin{DoxyParams}{Parameters}
{\em id} & completion queue id \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_aaf3fc9dd67e138eebe225f72d335eb19}\label{proc_8h_aaf3fc9dd67e138eebe225f72d335eb19}} 
\index{proc.h@{proc.h}!Proc\_Update\_Cq\_Deleted@{Proc\_Update\_Cq\_Deleted}}
\index{Proc\_Update\_Cq\_Deleted@{Proc\_Update\_Cq\_Deleted}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Cq\_Deleted()}{Proc\_Update\_Cq\_Deleted()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Cq\+\_\+\+Deleted (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}



remove the completion queue folder from the proc fs 


\begin{DoxyParams}{Parameters}
{\em id} & completion queue id \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_a76c832658b824fdd3f3e7444eed36998}\label{proc_8h_a76c832658b824fdd3f3e7444eed36998}} 
\index{proc.h@{proc.h}!Proc\_Update\_Ums\_Created@{Proc\_Update\_Ums\_Created}}
\index{Proc\_Update\_Ums\_Created@{Proc\_Update\_Ums\_Created}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Ums\_Created()}{Proc\_Update\_Ums\_Created()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Ums\+\_\+\+Created (\begin{DoxyParamCaption}\item[{int}]{ums\+\_\+pid,  }\item[{int}]{owner\+\_\+pid,  }\item[{int}]{id }\end{DoxyParamCaption})}



Insert the new UMS into the proc fs and link the completion queue path to the UMS folder. 


\begin{DoxyParams}{Parameters}
{\em ums\+\_\+pid} & pid of the UMS \\
\hline
{\em owner\+\_\+pid} & pid of the owner process of the UMS \\
\hline
{\em id} & completion queue id of the UMS \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_ae521fa6c4855e5a5f57c00d51f2e1df0}\label{proc_8h_ae521fa6c4855e5a5f57c00d51f2e1df0}} 
\index{proc.h@{proc.h}!Proc\_Update\_Ums\_Ended@{Proc\_Update\_Ums\_Ended}}
\index{Proc\_Update\_Ums\_Ended@{Proc\_Update\_Ums\_Ended}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Ums\_Ended()}{Proc\_Update\_Ums\_Ended()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Ums\+\_\+\+Ended (\begin{DoxyParamCaption}\item[{int}]{ums\+\_\+pid }\end{DoxyParamCaption})}



Remove the UMS directory from the proc fs. 


\begin{DoxyParams}{Parameters}
{\em ums\+\_\+pid} & pid of the ums \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_a4356ac452c746426b4d93a15c42642bd}\label{proc_8h_a4356ac452c746426b4d93a15c42642bd}} 
\index{proc.h@{proc.h}!Proc\_Update\_Worker\_Appended@{Proc\_Update\_Worker\_Appended}}
\index{Proc\_Update\_Worker\_Appended@{Proc\_Update\_Worker\_Appended}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Worker\_Appended()}{Proc\_Update\_Worker\_Appended()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Appended (\begin{DoxyParamCaption}\item[{int}]{wkt\+\_\+pid,  }\item[{int}]{id }\end{DoxyParamCaption})}



link a worker to its completion queue 


\begin{DoxyParams}{Parameters}
{\em wkt\+\_\+pid} & pid of the worker \\
\hline
{\em id} & completion queue where the worker need to be appended \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_a2cce105f1878949f055ac8fbb49450ad}\label{proc_8h_a2cce105f1878949f055ac8fbb49450ad}} 
\index{proc.h@{proc.h}!Proc\_Update\_Worker\_Created@{Proc\_Update\_Worker\_Created}}
\index{Proc\_Update\_Worker\_Created@{Proc\_Update\_Worker\_Created}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Worker\_Created()}{Proc\_Update\_Worker\_Created()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Created (\begin{DoxyParamCaption}\item[{int}]{wkt\+\_\+pid }\end{DoxyParamCaption})}



Insert the created worker thread into the procfs. 


\begin{DoxyParams}{Parameters}
{\em wkt\+\_\+pid} & pid of the worker \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_a9a86c1a056ba322a329c93bf8143756c}\label{proc_8h_a9a86c1a056ba322a329c93bf8143756c}} 
\index{proc.h@{proc.h}!Proc\_Update\_Worker\_Ended@{Proc\_Update\_Worker\_Ended}}
\index{Proc\_Update\_Worker\_Ended@{Proc\_Update\_Worker\_Ended}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{Proc\_Update\_Worker\_Ended()}{Proc\_Update\_Worker\_Ended()}}
{\footnotesize\ttfamily int Proc\+\_\+\+Update\+\_\+\+Worker\+\_\+\+Ended (\begin{DoxyParamCaption}\item[{int}]{wkt\+\_\+pid }\end{DoxyParamCaption})}



Remove the worker that has ended from the procfs. 


\begin{DoxyParams}{Parameters}
{\em wkt\+\_\+pid} & pid of the worker \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\mbox{\Hypertarget{proc_8h_a0066639f9bfabe52b228b58f38ab5e09}\label{proc_8h_a0066639f9bfabe52b228b58f38ab5e09}} 
\index{proc.h@{proc.h}!try\_build\_ums\_proc@{try\_build\_ums\_proc}}
\index{try\_build\_ums\_proc@{try\_build\_ums\_proc}!proc.h@{proc.h}}
\doxysubsubsection{\texorpdfstring{try\_build\_ums\_proc()}{try\_build\_ums\_proc()}}
{\footnotesize\ttfamily int try\+\_\+build\+\_\+ums\+\_\+proc (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



initialize the main data structures for the proc part for the ums 

\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
